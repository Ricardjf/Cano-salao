<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Ca침o Salao | Ruta Tur칤stica Mar칤tima | Barcelona, Venezuela</title>
    <meta name="description" content="Descubre la Ruta Tur칤stica Mar칤tima Ca침o Salao en Barcelona, Venezuela. Tours en barco por manglares, avistamiento de aves y turismo comunitario.">
    <meta name="keywords" content="Ca침o Salao, turismo Venezuela, Barcelona Anzo치tegui, ruta mar칤tima, manglares, tours en barco, turismo comunitario">
    <meta name="author" content="Estudiantes: Alejandra Paricaguan, Luis Nucete, Ricardo Far칤as | Tutora: Dulce Paraguan">
    
    <!-- FAVICON con tu logo -->
    <link rel="icon" type="image/png" sizes="32x32" href="media/Logo_cano_60.png">
    <link rel="icon" type="image/png" sizes="16x16" href="media/Logo_cano_60.png">
    <link rel="apple-touch-icon" href="media/Logo_cano_120.png">
    <meta name="theme-color" content="#0d3b66">
    
    <!-- Preload de fuentes cr칤ticas -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Times+New+Roman:ital,wght@0,400;0,700;1,400&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Times+New+Roman:ital,wght@0,400;0,700;1,400&display=swap"></noscript>
    
    <!-- Preload del logo para mejor performance -->
    <link rel="preload" href="media/Logo_cano_60.png" as="image">
    
    <!-- Estilos cr칤ticos inline -->
    <style>
        /* SOLO ESTILOS CR칈TICOS PARA RENDER INICIAL */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: rgba(0,0,0,0.1);
            -webkit-touch-callout: none;
        }
        
        html, body {
            width: 100%;
            overflow-x: hidden;
            touch-action: manipulation;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            line-height: 1.5;
            opacity: 1; /* IMPORTANTE: Siempre visible */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            position: relative;
        }
        
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header m칤nimo para render inicial */
        header {
            background: linear-gradient(135deg, #1a7fb8 0%, #0d3b66 100%);
            color: white;
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: 0.5rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 0.6rem;
            flex-shrink: 0;
            z-index: 1002;
        }
        
        /* Estilos cr칤ticos para el logo */
        .logo-img {
            width: 35px;
            height: 35px;
            object-fit: contain;
            border-radius: 50%;
            display: block;
            flex-shrink: 0;
            -webkit-user-select: none;
            user-select: none;
        }
        
        .logo h1 {
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
            margin: 0;
            white-space: nowrap;
        }
        
        .text-orange {
            color: #FF8C42;
        }
        
        /* Menu toggle para m칩vil */
        .menu-toggle {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.8rem;
            cursor: pointer;
            padding: 0.5rem;
            transition: all 0.2s ease;
            flex-shrink: 0;
            z-index: 1002;
            -webkit-tap-highlight-color: rgba(255,255,255,0.3);
            touch-action: manipulation;
            min-width: 44px;
            min-height: 44px;
            align-items: center;
            justify-content: center;
        }
        
        /* Navegaci칩n desktop */
        .nav-center {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        nav {
            width: 100%;
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 0.5rem;
            align-items: center;
            margin: 0;
            padding: 0;
            justify-content: center;
        }
        
        nav ul li {
            position: relative;
        }
        
        nav ul li a {
            color: rgba(255,255,255,0.95);
            text-decoration: none;
            font-weight: 500;
            padding: 0.4rem 0.6rem;
            border-radius: 4px;
            display: flex;
            align-items: center;
            gap: 0.3rem;
            transition: all 0.2s ease;
            font-size: 0.9rem;
            white-space: nowrap;
            -webkit-tap-highlight-color: rgba(255,255,255,0.1);
            touch-action: manipulation;
        }
        
        nav ul li a:hover {
            background: rgba(255,255,255,0.1);
        }
        
        nav ul li a.active {
            background: rgba(255,255,255,0.15);
        }
        
        /* MEN칔 M칍VIL - ESTILOS CR칈TICOS */
        .mobile-menu-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .mobile-menu-overlay.active {
            display: block;
            opacity: 1;
        }
        
        .mobile-menu-container {
            position: fixed;
            top: 0;
            right: -100%;
            width: 85%;
            max-width: 300px;
            height: 100%;
            background: linear-gradient(135deg, #1a7fb8 0%, #0d3b66 100%);
            z-index: 1000;
            overflow-y: auto;
            transition: right 0.3s ease;
            box-shadow: -2px 0 10px rgba(0,0,0,0.3);
        }
        
        .mobile-menu-container.active {
            right: 0;
        }
        
        .mobile-menu-header {
            padding: 1rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .mobile-menu-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.8rem;
            cursor: pointer;
            padding: 0.5rem;
            -webkit-tap-highlight-color: rgba(255,255,255,0.3);
            touch-action: manipulation;
            min-width: 44px;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .mobile-menu-nav {
            padding: 1rem 0;
        }
        
        .mobile-menu-nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: column;
        }
        
        .mobile-menu-nav li {
            border-bottom: 1px solid rgba(255,255,255,0.1);
            width: 100%;
        }
        
        .mobile-menu-nav li:last-child {
            border-bottom: none;
        }
        
        .mobile-menu-nav a {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.5rem;
            color: white;
            text-decoration: none;
            font-size: 1.1rem;
            transition: background 0.2s ease;
            -webkit-tap-highlight-color: rgba(255,255,255,0.2);
            touch-action: manipulation;
            width: 100%;
        }
        
        .mobile-menu-nav a.active {
            background: rgba(255,255,255,0.15);
            font-weight: 600;
        }
        
        .mobile-menu-nav a:hover {
            background: rgba(255,255,255,0.1);
        }
        
        /* User menu styles - MEJORADO */
        .user-menu-container {
            position: relative;
            z-index: 1002;
        }
        
        .logged-user {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 6px;
            transition: background-color 0.2s ease;
            -webkit-tap-highlight-color: transparent;
            min-height: 44px;
        }
        
        .logged-user:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .user-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3498db, #2c3e50);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
            flex-shrink: 0;
            transition: transform 0.2s ease;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .user-avatar:hover {
            transform: scale(1.05);
        }
        
        .user-info {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .user-name {
            font-size: 0.85rem;
            font-weight: 600;
            color: white;
            white-space: nowrap;
            max-width: 120px;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .user-role {
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.8);
            background: rgba(255, 255, 255, 0.1);
            padding: 1px 6px;
            border-radius: 10px;
            display: inline-block;
            text-transform: uppercase;
        }
        
        .user-role.admin {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            font-weight: bold;
        }
        
        /* Dropdown menu styles - FIXED */
        .user-dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            min-width: 220px;
            z-index: 1001;
            overflow: hidden;
            margin-top: 5px;
            display: none;
            animation: fadeInDown 0.2s ease;
            border: 1px solid #eee;
        }
        
        .user-dropdown-menu.show {
            display: block;
        }
        
        .user-dropdown-header {
            padding: 12px 15px;
            background: linear-gradient(135deg, #1a7fb8, #0d3b66);
            color: white;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .user-dropdown-email {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.9);
            margin-top: 2px;
        }
        
        .user-dropdown-menu a {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 15px;
            color: #333;
            text-decoration: none;
            border-bottom: 1px solid #eee;
            transition: background 0.2s;
            font-size: 14px;
            cursor: pointer;
        }
        
        .user-dropdown-menu a:hover {
            background: #f5f5f5;
        }
        
        .user-dropdown-menu a:last-child {
            border-bottom: none;
            color: #e74c3c;
        }
        
        .user-dropdown-menu a:last-child:hover {
            background: #ffeaea;
        }
        
        .admin-badge {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
            margin-left: auto;
        }
        
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Secci칩n de autenticaci칩n */
        .auth-section {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            flex-shrink: 0;
            z-index: 1002;
        }
        
        .login-btn {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            background: rgba(255,255,255,0.15);
            color: white;
            padding: 0.4rem 0.8rem;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            border: 1px solid rgba(255,255,255,0.2);
            font-size: 0.85rem;
            white-space: nowrap;
            min-height: 44px;
        }
        
        .login-btn:hover {
            background: rgba(255,255,255,0.25);
        }
        
        /* Hero b치sico para render inicial */
        .hero {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            padding: 2rem 1rem;
            position: relative;
            background: linear-gradient(135deg, #1a5276 0%, #2c82c9 100%);
        }
        
        .hero .container {
            position: relative;
            z-index: 2;
        }
        
        /* Preload de imagen del hero */
        .hero-preload {
            position: absolute;
            width: 0;
            height: 0;
            opacity: 0;
            pointer-events: none;
        }
        
        /* Esconder contenido no cr칤tico inicialmente */
        .non-critical {
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        /* Loader minimalista - MEJORADO */
        #page-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }
        
        #page-loader.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }
        
        .loader-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #0d3b66;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Alert styles */
        .site-alert {
            position: fixed;
            top: 80px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 6px;
            z-index: 9998;
            max-width: 300px;
            display: none;
            animation: slideInRight 0.3s ease;
        }
        
        .site-alert.success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        
        .site-alert.error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        
        .site-alert.info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* Responsive para m칩vil */
        @media (max-width: 768px) {
            .menu-toggle {
                display: flex !important;
            }
            
            .nav-center {
                display: none !important;
            }
            
            .header-content {
                flex-wrap: nowrap;
            }
            
            .logo {
                flex: 1;
            }
            
            .logo h1 {
                font-size: 1.4rem;
            }
            
            .auth-section {
                order: 3;
            }
            
            .mobile-menu-container {
                z-index: 1000;
            }
            
            .mobile-menu-overlay {
                z-index: 999;
            }
            
            .user-dropdown-menu {
                position: fixed;
                top: 60px;
                right: 10px;
                left: 10px;
                min-width: auto;
            }
            
            .user-info {
                display: none;
            }
            
            .logged-user {
                padding: 4px;
            }
        }
        
        @media (max-width: 576px) {
            .logo-img {
                width: 35px;
                height: 35px;
            }
            
            .logo h1 {
                font-size: 1.3rem;
            }
            
            .logo {
                gap: 0.5rem;
            }
            
            .header-content {
                gap: 0.5rem;
            }
            
            .user-avatar {
                width: 32px;
                height: 32px;
                font-size: 14px;
            }
        }
        
        /* CORRECCI칍N ESPEC칈FICA PARA ANDROID */
        @media (hover: none) and (pointer: coarse) {
            .menu-toggle,
            .mobile-menu-close,
            .mobile-menu-nav a,
            .btn,
            .login-btn {
                min-height: 44px;
            }
            
            .menu-toggle,
            .mobile-menu-close {
                min-width: 44px;
            }
            
            .menu-toggle:active,
            .mobile-menu-close:active {
                background-color: rgba(255,255,255,0.2);
                border-radius: 50%;
            }
            
            .user-avatar:active {
                transform: scale(0.95);
            }
        }
        
        /* Estilos para la secci칩n de tours */
        .tour-details {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            color: #666;
            font-size: 0.9rem;
        }
        
        .tour-details span {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .tour-loading {
            text-align: center;
            padding: 2rem;
            color: #666;
        }
        
        .tour-loading .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        .api-status {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            z-index: 1000;
            display: none; /* Ocultado por defecto */
        }
        
        .api-status.connected {
            background: rgba(46, 204, 113, 0.8);
        }
        
        .api-status.disconnected {
            background: rgba(231, 76, 60, 0.8);
        }
    </style>
    
    <!-- Cargar CSS principal de forma no bloqueante -->
    <link rel="stylesheet" href="index.css" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="index.css"></noscript>
    
    <!-- Bootstrap Icons diferido -->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"></noscript>
</head>
<body>
    <!-- Alert para mensajes -->
    <div id="site-alert" class="site-alert"></div>
    
    <!-- Indicador de estado de API (opcional) -->
    <div id="api-status" class="api-status">游댋 Conectando con API...</div>
    
    <!-- Loader para experiencia inicial -->
    <div id="page-loader" class="hidden">
        <div class="loader-spinner"></div>
    </div>

    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <img 
                        src="media/Logo_cano_60.png" 
                        srcset="media/Logo_cano_60.png 1x, media/Logo_cano_120.png 2x" 
                        alt="Logo Ca침o Salao - Ruta Tur칤stica Mar칤tima" 
                        class="logo-img"
                        width="35" 
                        height="35"
                        loading="eager"
                        aria-hidden="true"
                    >
                    <h1 class="times-font">Ca침o <span class="text-orange">Salao</span></h1>
                </div>

                <!-- Navegaci칩n desktop (oculta en m칩vil) -->
                <div class="nav-center">
                    <nav>
                        <ul id="main-navigation">
                            <li><a href="index.html" class="active"><i class="bi bi-house"></i> <span>Inicio</span></a></li>
                            <li><a href="Pages/Empresa.html"><i class="bi bi-building"></i> <span>Empresa</span></a></li>
                            <li><a href="Pages/Historia.html"><i class="bi bi-journal-text"></i> <span>Historia</span></a></li>
                            <li><a href="Pages/Servicios.html"><i class="bi bi-list-check"></i> <span>Servicios</span></a></li>
                            <li><a href="Pages/Atracciones.html"><i class="bi bi-star"></i> <span>Atracciones</span></a></li>
                            <li><a href="Pages/Contacto.html"><i class="bi bi-telephone"></i> <span>Contacto</span></a></li>
                        </ul>
                    </nav>
                </div>

                <!-- Men칰 de usuario/autenticaci칩n -->
                <div class="auth-section">
                    <div class="user-menu-container" id="user-menu-container">
                        <!-- Estado No Autenticado -->
                        <a href="Pages/login.html" class="login-btn" id="login-btn">
                            <i class="bi bi-person-circle"></i> <span class="login-text">Iniciar Sesi칩n</span>
                        </a>
                        
                        <!-- Estado Autenticado (manejado por JavaScript) -->
                        <div class="logged-user" id="logged-user" style="display: none;">
                            <div class="user-avatar" id="user-avatar" aria-label="Men칰 de usuario" role="button" tabindex="0" title="Men칰 de usuario">U</div>
                            <div class="user-info">
                                <div class="user-name" id="user-name">Usuario</div>
                                <div class="user-role" id="user-role">user</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bot칩n hamburguesa para m칩vil -->
                <button class="menu-toggle" id="mobile-menu-toggle" aria-label="Abrir men칰 de navegaci칩n" aria-expanded="false">
                    <i class="bi bi-list"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Men칰 m칩vil overlay (fondo oscuro) -->
    <div class="mobile-menu-overlay" id="mobile-menu-overlay"></div>

    <!-- Men칰 m칩vil (se abre desde la derecha) -->
    <div class="mobile-menu-container" id="mobile-menu-container">
        <div class="mobile-menu-header">
            <div class="logo">
                <img src="media/Logo_cano_60.png" alt="Logo Ca침o Salao" class="logo-img" width="35" height="35">
                <h2 class="times-font" style="color: white; font-size: 1.2rem;">Ca침o <span class="text-orange">Salao</span></h2>
            </div>
            <button class="mobile-menu-close" id="mobile-menu-close" aria-label="Cerrar men칰">
                <i class="bi bi-x-lg"></i>
            </button>
        </div>
        
        <nav class="mobile-menu-nav">
            <ul>
                <li><a href="index.html" class="active"><i class="bi bi-house"></i> Inicio</a></li>
                <li><a href="Pages/Empresa.html"><i class="bi bi-building"></i> Empresa</a></li>
                <li><a href="Pages/Historia.html"><i class="bi bi-journal-text"></i> Historia</a></li>
                <li><a href="Pages/Servicios.html"><i class="bi bi-list-check"></i> Servicios</a></li>
                <li><a href="Pages/Atracciones.html"><i class="bi bi-star"></i> Atracciones</a></li>
                <li><a href="Pages/Contacto.html"><i class="bi bi-telephone"></i> Contacto</a></li>
                <!-- Enlace de usuario si est치 autenticado -->
                <li id="mobile-user-menu" style="display: none;">
                    <a href="Pages/usuario.html"><i class="bi bi-person-circle"></i> Mi Cuenta</a>
                </li>
                <li id="mobile-login-menu" style="display: none;">
                    <a href="Pages/login.html"><i class="bi bi-box-arrow-in-right"></i> Iniciar Sesi칩n</a>
                </li>
            </ul>
        </nav>
    </div>

    <!-- Hero Section CON CONTENIDO DIN츼MICO -->
    <section class="hero">
        <div class="hero-bg" id="heroBackground"></div>
        <div class="container">
            <h2 class="times-font hero-title" id="hero-title">춰Descubre la Belleza Natural de <span class="text-orange">Ca침o</span> Salao!</h2>
            <p class="times-font hero-subtitle" id="hero-subtitle">
                Emb치rcate en una aventura 칰nica por los manglares de Barcelona, Venezuela. 
                <strong>Turismo comunitario</strong> que conecta naturaleza, historia y comunidad.
            </p>
            <a href="Pages/contacto.html" class="btn" id="hero-cta">
                <i class="bi bi-calendar-check"></i> 춰Reserva tu Tour Ahora!
            </a>
        </div>
    </section>
    
    <!-- Empresa Factible CON CONTENIDO DIN츼MICO -->
    <section id="empresa" class="non-critical">
        <div class="container">
            <div class="section-title">
                <h2 class="times-font"><i class="bi bi-building icon-comunidad"></i> Empresa de Producci칩n Social</h2>
                <p>Conoce nuestro modelo de negocio sostenible que beneficia a la comunidad de Ca침o Salao</p>
            </div>
            <div class="history-content">
                <div class="history-text">
                    <p id="empresa-desc-1">La empresa de producci칩n social de transporte tur칤stico acu치tico "Ca침o Salao" se establece como una entidad jur칤dica con el prop칩sito de ofrecer servicios tur칤sticos acu치ticos sostenibles en la comunidad de Ca침o Salao, ubicada en Barcelona, Municipio Sim칩n Bol칤var, estado Anzo치tegui.</p>
                    <p id="empresa-desc-2">Su raz칩n social refleja su compromiso con la protecci칩n del medio ambiente natural y el desarrollo socioecon칩mico de las comunidades locales.</p>
                    <a href="Pages/empresa.html" class="btn">
                        <i class="bi bi-info-circle icon-comunidad"></i> Conoce M치s
                    </a>
                </div>
                <div class="history-image">
                    <img src="https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80" alt="Nuestra empresa" loading="lazy" id="empresa-image">
                </div>
            </div>
            
            <div class="factible-features">
                <div class="factible-feature" data-feature-id="1">
                    <div class="factible-icon">
                        <i class="bi bi-tree-fill"></i>
                    </div>
                    <h3 class="times-font" data-content="feature-title-1">Sostenibilidad Ambiental</h3>
                    <p data-content="feature-desc-1">Comprometidos con la protecci칩n del ecosistema 칰nico de manglares y especies marinas de Ca침o Salao.</p>
                </div>
                <div class="factible-feature" data-feature-id="2">
                    <div class="factible-icon">
                        <i class="bi bi-people-fill"></i>
                    </div>
                    <h3 class="times-font" data-content="feature-title-2">Desarrollo Comunitario</h3>
                    <p data-content="feature-desc-2">Generamos empleo local y reinvertimos utilidades en proyectos que benefician a la comunidad.</p>
                </div>
                <div class="factible-feature" data-feature-id="3">
                    <div class="factible-icon">
                        <i class="bi bi-globe-americas"></i>
                    </div>
                    <h3 class="times-font" data-content="feature-title-3">Turismo Responsable</h3>
                    <p data-content="feature-desc-3">Ofrecemos experiencias aut칠nticas que respetan la cultura local y el medio ambiente.</p>
                </div>
                <div class="factible-feature" data-feature-id="4">
                    <div class="factible-icon">
                        <i class="bi bi-graph-up-arrow"></i>
                    </div>
                    <h3 class="times-font" data-content="feature-title-4">Modelo Econ칩mico S칩lido</h3>
                    <p data-content="feature-desc-4">Combinamos viabilidad econ칩mica con impacto social positivo para un desarrollo sostenible.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Historia -->
    <section id="historia" class="non-critical">
        <div class="container">
            <div class="section-title">
                <h2 class="times-font"><i class="bi bi-journal-text icon-historia"></i> Historia de Ca침o Salao</h2>
                <p>Conoce los or칤genes de esta comunidad pesquera y su transformaci칩n en un destino tur칤stico sostenible</p>
            </div>
            <div class="history-content">
                <div class="history-text">
                    <p id="historia-desc-1">Ca침o Salao es una peque침a aldea de pescadores ubicada en el estado Anzo치tegui, Venezuela, que surgi칩 a mediados del siglo XX gracias a la iniciativa de varias familias provenientes de Barcelona.</p>
                    <p id="historia-desc-2">Atra칤dos por los hermosos paisajes costeros y la abundancia de recursos marinos, estos pioneros decidieron establecerse en esta zona y construir sus hogares.</p>
                    <a href="Pages/historia.html" class="btn">
                        <i class="bi bi-clock-history icon-historia"></i> Ver Historia Completa
                    </a>
                </div>
                <div class="history-image">
                    <img src="https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80" alt="Paisaje de Ca침o Salao" loading="lazy" id="historia-image">
                </div>
            </div>
        </div>
    </section>

    <!-- Secci칩n: Tours desde API -->
    <section id="tours-api" class="non-critical">
        <div class="container">
            <div class="section-title">
                <h2 class="times-font"><i class="bi bi-geo-alt"></i> Nuestros Tours Disponibles</h2>
                <p>Descubre las experiencias que tenemos preparadas para ti (Cargando desde la API...)</p>
            </div>
            <div class="attractions-grid" id="tours-api-container">
                <!-- Los tours se cargar치n aqu칤 desde la API -->
                <div class="tour-loading">
                    <div class="spinner"></div>
                    <p>Cargando tours disponibles...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Secci칩n: 칔ltimos Art칤culos del Blog -->
    <section id="blog-preview" class="non-critical" style="display: none;">
        <div class="container">
            <div class="section-title">
                <h2 class="times-font"><i class="bi bi-newspaper"></i> 칔ltimas Noticias</h2>
                <p>Mantente informado sobre nuestros tours y actividades</p>
            </div>
            <div class="attractions-grid" id="blog-posts-container">
                <!-- Los art칤culos del blog se cargar치n aqu칤 din치micamente -->
                <div class="tour-loading">
                    <div class="spinner"></div>
                    <p>Cargando noticias del blog...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Atracciones CON CONTENIDO DIN츼MICO -->
    <section id="atracciones" class="non-critical">
        <div class="container">
            <div class="section-title">
                <h2 class="times-font"><i class="bi bi-star icon-turismo"></i> Atracciones Tur칤sticas</h2>
                <p>Descubre los tesoros naturales y culturales que hacen 칰nica a la ruta mar칤tima Ca침o Salao</p>
            </div>
            <div class="attractions-grid">
                <div class="attraction-card" data-attraction-id="1">
                    <div class="attraction-img">
                        <img src="https://images.unsplash.com/photo-1559827260-dc66d52bef19?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80" alt="Manglares" loading="lazy" data-content="attraction-image-1">
                    </div>
                    <div class="attraction-info">
                        <h3 class="times-font"><i class="bi bi-tree icon-naturaleza"></i> 
                            <span data-content="attraction-title-1">Recorrido por Manglares</span>
                        </h3>
                        <p data-content="attraction-desc-1">Navega entre los impresionantes manglares que albergan una rica biodiversidad de aves y especies marinas.</p>
                    </div>
                </div>
                <div class="attraction-card" data-attraction-id="2">
                    <div class="attraction-img">
                        <img src="https://images.unsplash.com/photo-1597076953441-3197b7c9c9b8?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80" alt="Puente Una Luz" loading="lazy" data-content="attraction-image-2">
                    </div>
                    <div class="attraction-info">
                        <h3 class="times-font"><i class="bi bi-bridge icon-historia"></i> 
                            <span data-content="attraction-title-2">Puente Una Luz</span>
                        </h3>
                        <p data-content="attraction-desc-2">Visita este hist칩rico puente construido hace muchos a침os, testigo del desarrollo de la comunidad.</p>
                    </div>
                </div>
                <div class="attraction-card" data-attraction-id="3">
                    <div class="attraction-img">
                        <img src="https://images.unsplash.com/photo-1580137189272-c9370b0d12c9?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80" alt="Ruinas de la Aduana" loading="lazy" data-content="attraction-image-3">
                    </div>
                    <div class="attraction-info">
                        <h3 class="times-font"><i class="bi bi-building icon-historia"></i> 
                            <span data-content="attraction-title-3">Ruinas de la Antigua Aduana</span>
                        </h3>
                        <p data-content="attraction-desc-3">Explora los restos de un edificio importante de la 칠poca colonial espa침ola que controlaba el comercio mar칤timo.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Secci칩n La Ruta CON CONTENIDO DIN츼MICO -->
    <section id="la-ruta" class="non-critical">
        <div class="container">
            <h2 class="times-font"><i class="bi bi-map"></i> <span id="la-ruta-title">Descubre Nuestra Ruta</span></h2>
            <p class="subtitle times-font" id="la-ruta-subtitle">Una experiencia 칰nica que combina naturaleza, historia y aventura en el coraz칩n de Ca침o Salao</p>
            
            <div class="programas">
                <div class="carta" data-route-id="1">
                    <div class="carta-header">
                        <img src="https://images.unsplash.com/photo-1559827260-dc66d52bef19?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Manglares" loading="lazy" data-content="route-image-1">
                    </div>
                    <div class="carta-content">
                        <h3 class="times-font"><i class="bi bi-flower1"></i> 
                            <span data-content="route-title-1">Manglares y Biodiversidad</span>
                        </h3>
                        <p data-content="route-desc-1">Explora los impresionantes manglares que albergan una rica diversidad de aves y especies marinas.</p>
                        <a href="#" class="carta-btn" data-content="route-btn-1">
                            <i class="bi bi-arrow-right-circle"></i> Saber M치s
                        </a>
                    </div>
                </div>
                
                <div class="carta" data-route-id="2">
                    <div class="carta-header">
                        <img src="https://images.unsplash.com/photo-1597076953441-3197b7c9c9b8?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Patrimonio Hist칩rico" loading="lazy" data-content="route-image-2">
                    </div>
                    <div class="carta-content">
                        <h3 class="times-font"><i class="bi bi-buildings"></i> 
                            <span data-content="route-title-2">Patrimonio Hist칩rico</span>
                        </h3>
                        <p data-content="route-desc-2">Descubre los tesoros hist칩ricos de Ca침o Salao, desde el Puente Una Luz hasta las ruinas coloniales.</p>
                        <a href="#" class="carta-btn" data-content="route-btn-2">
                            <i class="bi bi-arrow-right-circle"></i> Explorar Historia
                        </a>
                    </div>
                </div>
                
                <div class="carta" data-route-id="3">
                    <div class="carta-header">
                        <img src="https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Aventura Acu치tica" loading="lazy" data-content="route-image-3">
                    </div>
                    <div class="carta-content">
                        <h3 class="times-font"><i class="bi bi-compass"></i> 
                            <span data-content="route-title-3">Aventura Acu치tica</span>
                        </h3>
                        <p data-content="route-desc-3">Vive la emoci칩n de navegar por los canales y disfrutar de paisajes espectaculares.</p>
                        <a href="#" class="carta-btn" data-content="route-btn-3">
                            <i class="bi bi-arrow-right-circle"></i> Iniciar Aventura
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Secci칩n Caracter칤sticas CON CONTENIDO DIN츼MICO -->
    <section id="caracteristicas" class="non-critical">
        <div class="container">
            <div class="section-title">
                <h2 class="times-font"><i class="bi bi-check-circle"></i> <span id="caracteristicas-title">쯇or Qu칠 Elegirnos?</span></h2>
                <p id="caracteristicas-subtitle">Descubre lo que nos hace la mejor opci칩n para tu aventura en Ca침o Salao</p>
            </div>
            <div class="caracteristicas-grid">
                <div class="caracteristica-item" data-characteristic-id="1">
                    <span class="caracteristica-icon"><i class="bi bi-recycle"></i></span>
                    <h3 class="times-font" data-content="characteristic-title-1">Turismo Sostenible</h3>
                    <p data-content="characteristic-desc-1">Comprometidos con la protecci칩n del medio ambiente y el desarrollo de la comunidad local.</p>
                </div>
                
                <div class="caracteristica-item" data-characteristic-id="2">
                    <span class="caracteristica-icon"><i class="bi bi-person-badge"></i></span>
                    <h3 class="times-font" data-content="characteristic-title-2">Gu칤as Expertos</h3>
                    <p data-content="characteristic-desc-2">Nuestros gu칤as locales conocen cada rinc칩n de Ca침o Salao y su fascinante historia.</p>
                </div>
                
                <div class="caracteristica-item" data-characteristic-id="3">
                    <span class="caracteristica-icon"><i class="bi bi-shield-check"></i></span>
                    <h3 class="times-font" data-content="characteristic-title-3">Equipo Seguro</h3>
                    <p data-content="characteristic-desc-3">Embarcaciones modernas y equipos de seguridad para garantizar tu tranquilidad.</p>
                </div>
                
                <div class="caracteristica-item" data-characteristic-id="4">
                    <span class="caracteristica-icon"><i class="bi bi-cash-stack"></i></span>
                    <h3 class="times-font" data-content="characteristic-title-4">Precios Accesibles</h3>
                    <p data-content="characteristic-desc-4">Experiencias inolvidables a precios que respetan tu presupuesto.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Secci칩n Preguntas -->
    <section id="preguntas" class="non-critical">
        <div class="container">
            <h2 class="times-font"><i class="bi bi-question-circle"></i> 쯃isto para la Aventura?</h2>
            <p class="subtitle times-font">Reserva tu experiencia hoy mismo y descubre la magia de Ca침o Salao</p>
            
            <div class="cta-buttons">
                <a href="Pages/contacto.html" class="cta-btn">
                    <i class="bi bi-calendar-plus"></i> Reservar Ahora
                </a>
                <a href="Pages/Servicios.html" class="cta-btn secondary">
                    <i class="bi bi-eye"></i> Ver Tours
                </a>
            </div>
        </div>
    </section>

    <!-- Contacto CON SISTEMA DE RESERVAS -->
    <section id="contacto" class="non-critical">
        <div class="container">
            <div class="section-title">
                <h2 class="times-font"><i class="bi bi-chat-dots icon-contacto"></i> Contacto</h2>
                <p>Reserva tu tour o solicita m치s informaci칩n sobre nuestros servicios</p>
            </div>
            <div class="contact-content">
                <div class="contact-info">
                    <h3 class="times-font"><i class="bi bi-info-circle icon-contacto"></i> Informaci칩n de Contacto</h3>
                    <div class="contact-details">
                        <div class="contact-item">
                            <div class="contact-icon"><i class="bi bi-geo-alt-fill"></i></div>
                            <div>
                                <h4 class="times-font">Ubicaci칩n</h4>
                                <p>Sector Ca침o Salao, Barcelona, Municipio Sim칩n Bol칤var, Estado Anzo치tegui, Venezuela</p>
                            </div>
                        </div>
                        <div class="contact-item">
                            <div class="contact-icon"><i class="bi bi-telephone-fill"></i></div>
                            <div>
                                <h4 class="times-font">Tel칠fono</h4>
                                <p id="contact-phone">+58 412-205-6558</p>
                            </div>
                        </div>
                        <div class="contact-item">
                            <div class="contact-icon"><i class="bi bi-envelope-fill"></i></div>
                            <div>
                                <h4 class="times-font">Email</h4>
                                <p id="contact-email">info@canosalaotours.com</p>
                            </div>
                        </div>
                    </div>
                    <h3 class="times-font"><i class="bi bi-clock icon-contacto"></i> Horarios de Atenci칩n</h3>
                    <p id="contact-hours">Lunes a Domingo: 8:00 AM - 5:00 PM</p>
                </div>
                <div class="contact-form">
                    <form id="reservation-form" data-admin-system="true">
                        <input type="hidden" name="source" value="website">
                        <div class="form-group">
                            <label for="name" class="times-font"><i class="bi bi-person icon-contacto"></i> Nombre Completo *</label>
                            <input type="text" id="name" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="email" class="times-font"><i class="bi bi-envelope icon-contacto"></i> Correo Electr칩nico *</label>
                            <input type="email" id="email" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="phone" class="times-font"><i class="bi bi-telephone icon-contacto"></i> Tel칠fono</label>
                            <input type="tel" id="phone" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="tour" class="times-font"><i class="bi bi-signpost icon-contacto"></i> Tour de Inter칠s</label>
                            <select id="tour" class="form-control">
                                <option value="">Selecciona un tour</option>
                                <option value="Tour B치sico">Tour B치sico</option>
                                <option value="Tour Completo">Tour Completo</option>
                                <option value="Tour Fotogr치fico">Tour Fotogr치fico</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="message" class="times-font"><i class="bi bi-chat-text icon-contacto"></i> Mensaje</label>
                            <textarea id="message" class="form-control" placeholder="Cu칠ntanos sobre tus intereses o necesidades especiales..." rows="4"></textarea>
                        </div>
                        <button type="submit" class="btn">
                            <i class="bi bi-send"></i> Enviar Reserva
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="non-critical">
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3 class="times-font"><i class="bi bi-geo-alt"></i> Ruta Tur칤stica Ca침o Salao</h3>
                    <p>Empresa de producci칩n social de transporte tur칤stico acu치tico comprometida con el desarrollo sostenible de la comunidad y la protecci칩n del medio ambiente.</p>
                </div>
                <div class="footer-column">
                    <h3 class="times-font"><i class="bi bi-link"></i> Enlaces R치pidos</h3>
                    <ul class="footer-links">
                        <li><a href="index.html"><i class="bi bi-house"></i> Inicio</a></li>
                        <li><a href="Pages/Empresa.html"><i class="bi bi-building"></i> Empresa</a></li>
                        <li><a href="Pages/Historia.html"><i class="bi bi-journal-text"></i> Historia</a></li>
                        <li><a href="Pages/Servicios.html"><i class="bi bi-list-check"></i> Servicios</a></li>
                        <li><a href="Pages/Atracciones.html"><i class="bi bi-star"></i> Atracciones</a></li>
                        <li><a href="Pages/contacto.html"><i class="bi bi-telephone"></i> Contacto</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3 class="times-font"><i class="bi bi-people"></i> S칤guenos</h3>
                    <div class="social-links">
                        <a href="#" class="social-icon"><i class="bi bi-facebook"></i></a>
                        <a href="#" class="social-icon"><i class="bi bi-instagram"></i></a>
                        <a href="#" class="social-icon"><i class="bi bi-twitter"></i></a>
                    </div>
                </div>
            </div>
            <div class="copyright">
                <p><i class="bi bi-c-circle"></i> 2025 Ruta Tur칤stica Mar칤tima Ca침o Salao. Todos los derechos reservados.</p>
                <p style="font-size: 11px; color: #888;"><i class="bi bi-mortarboard"></i> Proyecto desarrollado por estudiantes del PNF en Inform치tica - Universidad Polit칠cnica Territorial "Jos칠 Antonio Anzo치tegui"</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        // ========== CONFIGURACI칍N API ==========
        const API_BASE_URL = 'https://cano-salao.onrender.com/api';
        const STORAGE_KEYS = {
            TOKEN: 'cano_salao_token',
            USER: 'cano_salao_user'
        };
        
        // Variables globales
        let currentUser = null;
        let isMobileMenuOpen = false;
        let toursData = [];
        let userDropdownOpen = false;
        
        // ========== INICIALIZACI칍N ==========
        // Iniciar inmediatamente
        (function init() {
            console.log('游 Inicializando sitio Ca침o Salao...');
            console.log('游깷 URL API:', API_BASE_URL);
            
            // Inicializar UI de usuario inmediatamente
            initializeUserUI();
            
            // Ocultar loader
            hideLoader();
            
            // Inicializar funcionalidades
            initFunctionality();
            
            // Cargar contenido din치mico despu칠s de un breve delay
            setTimeout(() => {
                loadToursFromAPI();
                loadBlogPostsFromAPI();
            }, 500);
            
            console.log('九 Sitio inicializado');
        })();
        
        function hideLoader() {
            const loader = document.getElementById('page-loader');
            if (loader) {
                // Ocultar loader inmediatamente
                loader.classList.add('hidden');
                
                // Mostrar contenido no cr칤tico
                const nonCritical = document.querySelectorAll('.non-critical');
                nonCritical.forEach((el, index) => {
                    setTimeout(() => {
                        el.style.opacity = '1';
                    }, index * 50);
                });
            }
        }
        
        // ========== SISTEMA DE AUTENTICACI칍N ==========
        
        function initializeUserUI() {
            // Verificar autenticaci칩n inmediatamente
            const authStatus = checkAuthentication();
            
            if (authStatus.authenticated) {
                console.log('九 Usuario autenticado:', authStatus.user.nombre);
                updateUserUI();
                
                // Verificar sesi칩n con servidor en segundo plano
                setTimeout(validateSessionWithServer, 1000);
            } else {
                console.log('좶잺 Usuario no autenticado');
                showLoginButton();
            }
            
            // Verificar si viene del login
            checkIfComingFromLogin();
        }
        
        function checkAuthentication() {
            const token = localStorage.getItem(STORAGE_KEYS.TOKEN);
            const userData = localStorage.getItem(STORAGE_KEYS.USER);
            
            if (!token || !userData) {
                return { authenticated: false };
            }
            
            try {
                const user = JSON.parse(userData);
                currentUser = user;
                return { authenticated: true, user: user };
            } catch (error) {
                console.error('Error parseando datos de usuario:', error);
                // Limpiar datos corruptos
                localStorage.removeItem(STORAGE_KEYS.TOKEN);
                localStorage.removeItem(STORAGE_KEYS.USER);
                return { authenticated: false, error: error };
            }
        }
        
        async function validateSessionWithServer() {
            const token = localStorage.getItem(STORAGE_KEYS.TOKEN);
            
            if (!token || !currentUser) {
                return false;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/user/profile`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const user = await response.json();
                    // Actualizar datos de usuario
                    localStorage.setItem(STORAGE_KEYS.USER, JSON.stringify(user));
                    currentUser = user;
                    updateUserUI();
                    console.log('九 Sesi칩n validada con servidor');
                    return true;
                } else {
                    console.log('Token inv치lido en servidor');
                    clearUserSession();
                    return false;
                }
            } catch (error) {
                console.error('Error validando sesi칩n con servidor:', error);
                // Si hay error de red, mantener sesi칩n local
                return true;
            }
        }
        
        function clearUserSession() {
            localStorage.removeItem(STORAGE_KEYS.TOKEN);
            localStorage.removeItem(STORAGE_KEYS.USER);
            currentUser = null;
            showLoginButton();
            console.log('九 Sesi칩n limpiada');
        }
        
        function showLoginButton() {
            const loginBtn = document.getElementById('login-btn');
            const loggedUser = document.getElementById('logged-user');
            const mobileUserMenu = document.getElementById('mobile-user-menu');
            const mobileLoginMenu = document.getElementById('mobile-login-menu');
            
            if (loginBtn) {
                loginBtn.style.display = 'flex';
                loginBtn.href = 'Pages/login.html';
            }
            if (loggedUser) loggedUser.style.display = 'none';
            if (mobileUserMenu) mobileUserMenu.style.display = 'none';
            if (mobileLoginMenu) mobileLoginMenu.style.display = 'block';
            
            // Cerrar dropdown si est치 abierto
            closeUserDropdown();
        }
        
        function updateUserUI() {
            if (!currentUser) return;
            
            const loginBtn = document.getElementById('login-btn');
            const loggedUser = document.getElementById('logged-user');
            const userAvatar = document.getElementById('user-avatar');
            const userName = document.getElementById('user-name');
            const userRole = document.getElementById('user-role');
            const mobileUserMenu = document.getElementById('mobile-user-menu');
            const mobileLoginMenu = document.getElementById('mobile-login-menu');
            
            // Mostrar usuario logueado
            if (loginBtn) loginBtn.style.display = 'none';
            if (loggedUser) loggedUser.style.display = 'flex';
            if (mobileUserMenu) mobileUserMenu.style.display = 'block';
            if (mobileLoginMenu) mobileLoginMenu.style.display = 'none';
            
            // Configurar informaci칩n del usuario
            if (userName) {
                userName.textContent = currentUser.nombre || currentUser.email.split('@')[0];
            }
            
            if (userRole) {
                userRole.textContent = currentUser.rol || 'user';
                userRole.className = 'user-role ' + (currentUser.rol === 'admin' ? 'admin' : 'user');
            }
            
            // Configurar avatar
            if (userAvatar) {
                // Usar la primera letra del nombre o email
                const displayChar = currentUser.nombre 
                    ? currentUser.nombre.charAt(0).toUpperCase()
                    : currentUser.email.charAt(0).toUpperCase();
                
                userAvatar.textContent = displayChar;
                
                // Configurar color basado en rol
                if (currentUser.rol === 'admin') {
                    userAvatar.style.background = 'linear-gradient(135deg, #e74c3c, #c0392b)';
                    userAvatar.title = `Admin: ${currentUser.nombre || currentUser.email}`;
                } else {
                    userAvatar.style.background = 'linear-gradient(135deg, #3498db, #2c3e50)';
                    userAvatar.title = `Usuario: ${currentUser.nombre || currentUser.email}`;
                }
                
                // Configurar eventos del avatar
                setupUserAvatarEvents(userAvatar);
            }
            
            console.log('九 UI actualizada para usuario:', currentUser.nombre || currentUser.email);
        }
        
        function setupUserAvatarEvents(avatarElement) {
            if (!avatarElement) return;
            
            // Configurar click para abrir dropdown
            avatarElement.addEventListener('click', function(e) {
                e.stopPropagation();
                toggleUserDropdown();
            });
            
            // Configurar eventos de teclado
            avatarElement.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    toggleUserDropdown();
                }
            });
        }
        
        function toggleUserDropdown() {
            const dropdown = document.getElementById('user-dropdown-menu');
            
            if (!dropdown) {
                createUserDropdown();
            } else {
                if (userDropdownOpen) {
                    closeUserDropdown();
                } else {
                    dropdown.classList.add('show');
                    userDropdownOpen = true;
                    
                    // Configurar eventos para cerrar dropdown
                    setupDropdownCloseEvents();
                }
            }
        }
        
        function setupDropdownCloseEvents() {
            // Cerrar al hacer clic fuera
            const closeOnClickOutside = (e) => {
                const dropdown = document.getElementById('user-dropdown-menu');
                const avatar = document.getElementById('user-avatar');
                if (dropdown && 
                    !dropdown.contains(e.target) && 
                    !avatar.contains(e.target) && 
                    userDropdownOpen) {
                    closeUserDropdown();
                }
            };
            
            // Cerrar con Escape
            const closeOnEscape = (e) => {
                if (e.key === 'Escape' && userDropdownOpen) {
                    closeUserDropdown();
                }
            };
            
            // Agregar event listeners temporales
            document.addEventListener('click', closeOnClickOutside);
            document.addEventListener('keydown', closeOnEscape);
            
            // Guardar referencias para remover luego
            window._closeOnClickOutside = closeOnClickOutside;
            window._closeOnEscape = closeOnEscape;
        }
        
        function removeDropdownCloseEvents() {
            if (window._closeOnClickOutside) {
                document.removeEventListener('click', window._closeOnClickOutside);
            }
            if (window._closeOnEscape) {
                document.removeEventListener('keydown', window._closeOnEscape);
            }
        }
        
        function closeUserDropdown() {
            const dropdown = document.getElementById('user-dropdown-menu');
            if (dropdown) {
                dropdown.classList.remove('show');
                userDropdownOpen = false;
                
                // Remover event listeners
                removeDropdownCloseEvents();
            }
        }
        
        function createUserDropdown() {
            // Remover dropdown existente si hay
            const existingDropdown = document.getElementById('user-dropdown-menu');
            if (existingDropdown) {
                existingDropdown.remove();
            }
            
            // Crear dropdown
            const dropdown = document.createElement('div');
            dropdown.id = 'user-dropdown-menu';
            dropdown.className = 'user-dropdown-menu';
            
            const isAdmin = currentUser && currentUser.rol === 'admin';
            
            dropdown.innerHTML = `
                <div class="user-dropdown-header">
                    <div style="font-weight: bold; font-size: 16px;">${currentUser.nombre || 'Usuario'}</div>
                    <div class="user-dropdown-email">${currentUser.email}</div>
                    ${isAdmin ? '<div style="font-size: 12px; margin-top: 4px; padding: 2px 8px; background: rgba(255,255,255,0.2); border-radius: 4px; display: inline-block;">Administrador</div>' : ''}
                </div>
                <a href="Pages/usuario.html" class="dropdown-item" id="user-account-link">
                    <i class="bi bi-person"></i> Mi Cuenta
                    ${isAdmin ? '<span class="admin-badge">ADMIN</span>' : ''}
                </a>
                ${isAdmin ? `
                <a href="Pages/admin.html" class="dropdown-item">
                    <i class="bi bi-shield-check"></i> Panel de Administraci칩n
                </a>
                ` : ''}
                <a href="Pages/reservas.html" class="dropdown-item">
                    <i class="bi bi-calendar-check"></i> Mis Reservas
                </a>
                <a href="#" id="dropdown-logout-btn" class="dropdown-item">
                    <i class="bi bi-box-arrow-right"></i> Cerrar Sesi칩n
                </a>
            `;
            
            // Configurar eventos para los enlaces del dropdown
            const accountLink = dropdown.querySelector('#user-account-link');
            if (accountLink) {
                accountLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    // Guardar en sessionStorage que vamos a usuario.html
                    sessionStorage.setItem('redirecting_to_user', 'true');
                    window.location.href = 'Pages/usuario.html';
                });
            }
            
            const logoutBtn = dropdown.querySelector('#dropdown-logout-btn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    logout();
                });
            }
            
            // A침adir estilos para hover
            dropdown.querySelectorAll('.dropdown-item').forEach(item => {
                item.addEventListener('mouseenter', function() {
                    this.style.background = '#f5f5f5';
                });
                item.addEventListener('mouseleave', function() {
                    this.style.background = '';
                });
            });
            
            // A침adir al DOM
            const userMenuContainer = document.getElementById('user-menu-container');
            userMenuContainer.appendChild(dropdown);
            
            // Mostrar dropdown
            setTimeout(() => {
                dropdown.classList.add('show');
                userDropdownOpen = true;
                
                // Configurar eventos para cerrar dropdown
                setupDropdownCloseEvents();
            }, 10);
        }
        
        function logout() {
            if (confirm('쮼st치s seguro de cerrar sesi칩n?')) {
                clearUserSession();
                showAlert('Sesi칩n cerrada correctamente', 'info');
                
                // Redirigir al inicio si est치 en p치ginas protegidas
                const currentPath = window.location.pathname;
                if (currentPath.includes('usuario.html') || 
                    currentPath.includes('admin.html') ||
                    currentPath.includes('reservas.html')) {
                    setTimeout(() => {
                        window.location.href = '../index.html';
                    }, 1000);
                }
            }
        }
        
        function checkIfComingFromLogin() {
            const urlParams = new URLSearchParams(window.location.search);
            const fromLogin = urlParams.get('fromLogin');
            const loginSuccess = urlParams.get('loginSuccess');
            
            if (fromLogin === 'true' || loginSuccess === 'true') {
                console.log('游댐 Usuario viene del login');
                
                // Remover par치metros de la URL
                const cleanUrl = window.location.pathname;
                window.history.replaceState({}, document.title, cleanUrl);
                
                // Mostrar mensaje de bienvenida
                if (currentUser) {
                    setTimeout(() => {
                        showAlert(`춰Bienvenido/a ${currentUser.nombre}! Has iniciado sesi칩n correctamente.`, 'success');
                    }, 1000);
                }
            }
        }
        
        // ========== CARGAR TOURS DESDE API ==========
        
        async function loadToursFromAPI() {
            try {
                updateApiStatus('游댃 Cargando tours...', '');
                
                const response = await fetch(`${API_BASE_URL}/tours`);
                
                if (!response.ok) {
                    throw new Error(`Error ${response.status}: ${response.statusText}`);
                }
                
                const tours = await response.json();
                toursData = tours;
                
                // Actualizar estado API
                updateApiStatus('九 API Conectada', 'connected');
                
                // Renderizar tours
                renderTours(tours);
                
                console.log('九 Tours cargados desde API:', tours.length);
                
            } catch (error) {
                console.error('仇 Error cargando tours:', error);
                updateApiStatus('仇 Error API', 'disconnected');
                
                // Mostrar tours de respaldo
                renderFallbackTours();
                
                // Mostrar error
                setTimeout(() => {
                    showAlert('No se pudieron cargar los tours. Mostrando informaci칩n de respaldo.', 'error');
                }, 3000);
            }
        }
        
        function renderTours(tours) {
            const container = document.getElementById('tours-api-container');
            if (!container) return;
            
            container.innerHTML = '';
            
            if (!tours || tours.length === 0) {
                container.innerHTML = `
                    <div class="tour-loading">
                        <i class="bi bi-exclamation-triangle" style="font-size: 2rem; color: #f39c12; margin-bottom: 1rem;"></i>
                        <p>No hay tours disponibles en este momento.</p>
                        <button onclick="loadToursFromAPI()" style="margin-top: 1rem; padding: 8px 16px; background: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;">
                            <i class="bi bi-arrow-clockwise"></i> Reintentar
                        </button>
                    </div>
                `;
                return;
            }
            
            // Mostrar solo los primeros 3 tours
            const toursToShow = tours.slice(0, 3);
            
            toursToShow.forEach(tour => {
                const card = document.createElement('div');
                card.className = 'attraction-card';
                card.innerHTML = `
                    <div class="attraction-img">
                        <img src="${tour.imagen_url || 'https://images.unsplash.com/photo-1559827260-dc66d52bef19?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80'}" 
                             alt="${tour.nombre}" 
                             loading="lazy"
                             onerror="this.src='https://images.unsplash.com/photo-1559827260-dc66d52bef19?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80'">
                    </div>
                    <div class="attraction-info">
                        <h3 class="times-font">
                            <i class="bi bi-geo-alt" style="color: #3498db;"></i> ${tour.nombre}
                        </h3>
                        <p>${tour.descripcion || 'Descripci칩n no disponible'}</p>
                        <div class="tour-details">
                            <span><i class="bi bi-clock"></i> ${tour.duracion || '2 horas'}</span>
                            <span><i class="bi bi-currency-dollar"></i> $${tour.precio || '25.00'}</span>
                        </div>
                        ${currentUser ? `
                        <button onclick="bookTour('${tour.id}', '${tour.nombre}')" style="margin-top: 10px; padding: 8px 16px; background: var(--color-accent); color: white; border: none; border-radius: 4px; cursor: pointer; width: 100%;">
                            <i class="bi bi-calendar-plus"></i> Reservar Ahora
                        </button>
                        ` : ''}
                    </div>
                `;
                container.appendChild(card);
            });
        }
        
        function renderFallbackTours() {
            const container = document.getElementById('tours-api-container');
            if (!container) return;
            
            container.innerHTML = '';
            
            const fallbackTours = [
                {
                    id: 1,
                    nombre: 'Tour B치sico',
                    descripcion: 'Recorrido por los manglares con gu칤a local',
                    duracion: '2 horas',
                    precio: '25.00',
                    imagen_url: 'https://images.unsplash.com/photo-1559827260-dc66d52bef19?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60'
                },
                {
                    id: 2,
                    nombre: 'Tour Completo',
                    descripcion: 'Experiencia completa que incluye todas las atracciones',
                    duracion: '4 horas',
                    precio: '45.00',
                    imagen_url: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60'
                },
                {
                    id: 3,
                    nombre: 'Tour Fotogr치fico',
                    descripcion: 'Especial para fotograf칤a de naturaleza y paisajes',
                    duracion: '3 horas',
                    precio: '35.00',
                    imagen_url: 'https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60'
                }
            ];
            
            renderTours(fallbackTours);
        }
        
        function bookTour(tourId, tourName) {
            if (!currentUser) {
                showAlert('Debes iniciar sesi칩n para reservar tours', 'error');
                window.location.href = 'Pages/login.html';
                return;
            }
            
            showAlert(`Redirigiendo para reservar: ${tourName}`, 'info');
            
            // Guardar el tour seleccionado
            sessionStorage.setItem('selected_tour', JSON.stringify({
                id: tourId,
                nombre: tourName
            }));
            
            // Redirigir
            setTimeout(() => {
                window.location.href = 'Pages/contacto.html';
            }, 1500);
        }
        
        // ========== CARGAR BLOG DESDE API ==========
        
        async function loadBlogPostsFromAPI() {
            try {
                const response = await fetch(`${API_BASE_URL}/blog`);
                
                if (!response.ok) {
                    throw new Error(`Error ${response.status}`);
                }
                
                const posts = await response.json();
                
                if (posts && posts.length > 0) {
                    document.getElementById('blog-preview').style.display = 'block';
                    renderBlogPostsFromAPI(posts);
                }
                
                console.log('九 Blog cargado desde API:', posts.length);
                
            } catch (error) {
                console.error('仇 Error cargando blog:', error);
                document.getElementById('blog-preview').style.display = 'none';
            }
        }
        
        function renderBlogPostsFromAPI(posts) {
            const container = document.getElementById('blog-posts-container');
            if (!container) return;
            
            container.innerHTML = '';
            
            const recentPosts = posts.slice(0, 3);
            
            recentPosts.forEach(post => {
                const postDate = new Date(post.created_at);
                const formattedDate = postDate.toLocaleDateString('es-ES', {
                    day: 'numeric',
                    month: 'short',
                    year: 'numeric'
                });
                
                const card = document.createElement('div');
                card.className = 'attraction-card';
                card.innerHTML = `
                    <div class="attraction-img">
                        ${post.imagen_url ? 
                            `<img src="${post.imagen_url}" alt="${post.titulo}" loading="lazy"
                                 onerror="this.src='https://images.unsplash.com/photo-1559827260-dc66d52bef19?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60'">` : 
                            `<div style="width:100%;height:180px;background:linear-gradient(135deg, #2c3e50, #3498db);display:flex;align-items:center;justify-content:center;">
                                <i class="bi bi-newspaper" style="font-size:48px;color:white;"></i>
                            </div>`
                        }
                    </div>
                    <div class="attraction-info">
                        <h3 class="times-font">
                            <i class="bi bi-newspaper" style="color:#3498db;"></i> 
                            ${post.titulo && post.titulo.length > 40 ? post.titulo.substring(0, 40) + '...' : post.titulo || 'Sin t칤tulo'}
                        </h3>
                        <div style="display:flex;justify-content:space-between;align-items:center;margin:10px 0;font-size:12px;color:#666;">
                            <span><i class="bi bi-calendar"></i> ${formattedDate}</span>
                            ${post.vistas ? `<span><i class="bi bi-eye"></i> ${post.vistas}</span>` : ''}
                        </div>
                        <p>${post.excerpt || (post.contenido ? post.contenido.substring(0, 100) + '...' : 'Sin contenido disponible')}</p>
                        <a href="#" style="color:#3498db;text-decoration:none;font-size:14px;display:inline-flex;align-items:center;gap:5px;margin-top:10px;">
                            <i class="bi bi-arrow-right"></i> Leer m치s
                        </a>
                    </div>
                `;
                container.appendChild(card);
            });
        }
        
        // ========== FUNCIONES DE UTILIDAD ==========
        
        function updateApiStatus(message, statusClass = '') {
            const statusElement = document.getElementById('api-status');
            if (!statusElement) return;
            
            statusElement.textContent = message;
            statusElement.className = 'api-status ' + statusClass;
            statusElement.style.display = 'block';
        }
        
        function showAlert(message, type = 'info') {
            const alertDiv = document.getElementById('site-alert');
            if (!alertDiv) return;
            
            alertDiv.textContent = message;
            alertDiv.className = `site-alert ${type}`;
            alertDiv.style.display = 'block';
            
            setTimeout(() => {
                alertDiv.style.display = 'none';
            }, 4000);
        }
        
        // ========== SISTEMA DE MEN칔 M칍VIL ==========
        
        function initFunctionality() {
            // ========== MEN칔 M칍VIL ==========
            const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
            const mobileMenuClose = document.getElementById('mobile-menu-close');
            const mobileMenuContainer = document.getElementById('mobile-menu-container');
            const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');
            
            function openMobileMenu() {
                mobileMenuContainer.classList.add('active');
                mobileMenuOverlay.classList.add('active');
                document.body.style.overflow = 'hidden';
                isMobileMenuOpen = true;
                mobileMenuToggle.setAttribute('aria-expanded', 'true');
                mobileMenuToggle.innerHTML = '<i class="bi bi-x-lg"></i>';
                
                closeUserDropdown();
            }
            
            function closeMobileMenu() {
                mobileMenuContainer.classList.remove('active');
                mobileMenuOverlay.classList.remove('active');
                document.body.style.overflow = '';
                isMobileMenuOpen = false;
                mobileMenuToggle.setAttribute('aria-expanded', 'false');
                mobileMenuToggle.innerHTML = '<i class="bi bi-list"></i>';
            }
            
            if (mobileMenuToggle) {
                mobileMenuToggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    if (!isMobileMenuOpen) {
                        openMobileMenu();
                    } else {
                        closeMobileMenu();
                    }
                });
            }
            
            if (mobileMenuClose) {
                mobileMenuClose.addEventListener('click', closeMobileMenu);
            }
            
            if (mobileMenuOverlay) {
                mobileMenuOverlay.addEventListener('click', closeMobileMenu);
            }
            
            // Cerrar men칰 m칩vil al hacer clic en enlaces
            const mobileMenuLinks = document.querySelectorAll('.mobile-menu-nav a');
            mobileMenuLinks.forEach(link => {
                link.addEventListener('click', closeMobileMenu);
            });
            
            // Cerrar men칰 m칩vil con Escape
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && isMobileMenuOpen) {
                    closeMobileMenu();
                }
            });
            
            // ========== CARGAR IMAGEN DEL HERO ==========
            loadHeroImage();
            
            // ========== CONFIGURAR FORMULARIO DE RESERVAS ==========
            const reservationForm = document.getElementById('reservation-form');
            if (reservationForm) {
                reservationForm.addEventListener('submit', handleReservationSubmit);
            }
            
            // ========== MEJORAS PARA M칍VIL ==========
            if (navigator.userAgent.match(/iPhone|iPad|iPod/i)) {
                const inputs = document.querySelectorAll('input, textarea, select');
                inputs.forEach(input => {
                    input.addEventListener('focus', function() {
                        this.style.fontSize = '16px';
                    });
                });
            }
        }
        
        function loadHeroImage() {
            const heroBg = document.querySelector('.hero-bg');
            if (!heroBg) return;
            
            const localImg = new Image();
            localImg.src = 'media/upscalemedia-transformed.jpeg';
            
            localImg.onload = function() {
                heroBg.style.backgroundImage = `linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('${this.src}')`;
            };
            
            localImg.onerror = function() {
                heroBg.style.backgroundImage = `linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80')`;
            };
        }
        
        function handleReservationSubmit(e) {
            e.preventDefault();
            
            const name = document.getElementById('name').value.trim();
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const tour = document.getElementById('tour').value;
            const message = document.getElementById('message').value.trim();
            
            if (!name || !email) {
                showAlert('Por favor completa los campos requeridos (Nombre y Email)', 'error');
                return;
            }
            
            const button = e.target.querySelector('button[type="submit"]');
            const originalText = button.innerHTML;
            button.innerHTML = '<i class="bi bi-arrow-repeat spin"></i> Enviando...';
            button.disabled = true;
            
            const booking = {
                id: Date.now(),
                codigo: 'RES-' + Date.now().toString().slice(-6),
                nombre: name,
                email: email,
                telefono: phone,
                tour: tour,
                mensaje: message,
                fecha: new Date().toISOString().split('T')[0],
                estado: 'pending',
                source: 'website',
                created_at: new Date().toISOString(),
                usuario_id: currentUser ? currentUser.id : null
            };
            
            const bookingsData = JSON.parse(localStorage.getItem('cano_salao_bookings') || '[]');
            bookingsData.push(booking);
            localStorage.setItem('cano_salao_bookings', JSON.stringify(bookingsData));
            
            setTimeout(() => {
                showAlert(`춰Gracias ${name}! Tu reserva ha sido enviada. C칩digo: ${booking.codigo}`, 'success');
                
                e.target.reset();
                button.innerHTML = originalText;
                button.disabled = false;
                
                if (currentUser) {
                    console.log(`游닇 Reserva creada por ${currentUser.nombre}: ${booking.codigo}`);
                }
            }, 1500);
        }
        
        // ========== EXPORTAR FUNCIONES GLOBALES ==========
        window.CanoSalaoAuth = {
            currentUser: () => currentUser,
            STORAGE_KEYS: STORAGE_KEYS,
            API_BASE_URL: API_BASE_URL,
            checkAuthentication: checkAuthentication,
            logout: logout,
            showAlert: showAlert,
            validateSession: validateSessionWithServer
        };
        
        console.log('九 index.html: Script cargado correctamente');
        
    </script>
</body>
</html>
